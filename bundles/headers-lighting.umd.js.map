{"version":3,"file":"headers-lighting.umd.js","sources":["../../src/modules/headers-lighting.ts","../../src/modules/headers-lighting.directive.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\n\nimport { HeadersLightingDirective } from './headers-lighting.directive';\n\n@NgModule({\n  declarations: [HeadersLightingDirective],\n  exports: [HeadersLightingDirective],\n  imports: [],\n  providers: []\n})\nexport class HeadersLightingModule { }\n","import { Directive, ElementRef, AfterViewChecked, AfterViewInit, OnDestroy } from '@angular/core';\n\n@Directive({\n  selector: '[headersLighting]'\n})\n\nexport class HeadersLightingDirective implements AfterViewChecked, AfterViewInit, OnDestroy {\n  private tds = [];\n  private listeners = new Map();\n\n  constructor(private elementRef: ElementRef) { }\n\n  onMouseOver() {\n    const table = this.elementRef.nativeElement;\n\n    return function onMouseOver(event) {\n      const cellIndex = event.target.cellIndex + 1;\n\n      if (!cellIndex || event.target === 'tr') {\n        return;\n      }\n\n      const targetCell = table.querySelector('thead tr:not([disabled]) th:nth-child(' + cellIndex + ')');\n      targetCell.classList.add('header-light');\n    };\n  }\n\n  onMouseOut() {\n    const table = this.elementRef.nativeElement;\n\n    return function onMouseOut(event) {\n      const cellIndex = event.target.cellIndex + 1;\n\n      if (!cellIndex) {\n        return;\n      }\n\n      const targetCell = table.querySelector('thead tr:not([disabled]) th:nth-child(' + cellIndex + ')');\n      targetCell.classList.remove('header-light');\n    };\n  }\n\n  ngAfterViewInit() {\n    const tbody = this.elementRef.nativeElement.querySelector('tbody');\n    this.tds = tbody.querySelectorAll('td:not([disabled])');\n\n    if (this.tds.length) {\n      this.deployListeners();\n    }\n  }\n\n  ngAfterViewChecked() {\n    const tbody = this.elementRef.nativeElement.querySelector('tbody');\n    const newTds = tbody.querySelectorAll('td:not([disabled])');\n\n    if (newTds.length !== this.tds.length) {\n      this.tds = newTds;\n      this.deployListeners();\n    }\n  }\n\n  deployListeners() {\n    this.destroyListeners();\n    this.initListeners();\n  }\n\n  initListeners() {\n    this.tds.forEach((td, i) => {\n      if (this.listeners.has(td)) {\n        const listener = this.listeners.get(td);\n        listener.index = i;\n        return;\n      }\n\n      this.listeners.set(td, {\n        mouseover: this.onMouseOver(),\n        mouseout: this.onMouseOut()\n      });\n\n      const listeners = this.listeners.get(td);\n      td.addEventListener('mouseover', listeners.mouseover);\n      td.addEventListener('mouseout', listeners.mouseout);\n    });\n  }\n\n  destroyListeners() {\n    this.listeners.forEach((a) => {\n      if (!this.listeners.has(a)) {\n        return;\n      }\n\n      const listeners = this.listeners.get(a);\n      a.removeEventListener('mouseover', listeners.mouseover);\n      a.removeEventListener('mouseout', listeners.mouseout);\n      this.listeners.delete(a);\n    });\n  }\n\n  ngOnDestroy() {\n    this.destroyListeners();\n  }\n}\n"],"names":["NgModule","ElementRef","Directive"],"mappings":"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"}