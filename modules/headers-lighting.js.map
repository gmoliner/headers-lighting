{"version":3,"file":"headers-lighting.js","sources":["../../headers-lighting.ts","../../public-api.ts","../../src/headers-lighting.ts","../../src/modules/headers-lighting.ts","../../src/modules/headers-lighting.directive.ts"],"sourcesContent":["export * from './public-api';\n","/**\n * Angular library starter.\n * Build an Angular library compatible with AoT compilation & Tree shaking.\n * Written by Roberto Simonetti.\n * MIT license.\n * https://github.com/robisim74/angular-library-starter\n */\n\n/**\n * Entry point for all public APIs of the package.\n */\nexport * from './src/headers-lighting';\n\n","export { HeadersLightingDirective } from './modules/headers-lighting.directive';\nexport { HeadersLightingModule } from './modules/headers-lighting';\n","import { NgModule } from '@angular/core';\n\nimport { HeadersLightingDirective } from './headers-lighting.directive';\n\n@NgModule({\n  declarations: [HeadersLightingDirective],\n  exports: [HeadersLightingDirective],\n  imports: [],\n  providers: []\n})\nexport class HeadersLightingModule { }\n","import { Directive, ElementRef, AfterViewChecked, AfterViewInit, OnDestroy } from '@angular/core';\n\n@Directive({\n  selector: '[headersLighting]'\n})\n\nexport class HeadersLightingDirective implements AfterViewChecked, AfterViewInit, OnDestroy {\n  private tds = [];\n  private listeners = new Map();\n\n  constructor(private elementRef: ElementRef) { }\n\n  onMouseOver() {\n    const table = this.elementRef.nativeElement;\n\n    return function onMouseOver(event) {\n      const cellIndex = event.target.cellIndex + 1;\n\n      if (!cellIndex || event.target === 'tr') {\n        return;\n      }\n\n      const targetCell = table.querySelector('thead tr:not([disabled]) th:nth-child(' + cellIndex + ')');\n      targetCell.classList.add('header-light');\n    };\n  }\n\n  onMouseOut() {\n    const table = this.elementRef.nativeElement;\n\n    return function onMouseOut(event) {\n      const cellIndex = event.target.cellIndex + 1;\n\n      if (!cellIndex) {\n        return;\n      }\n\n      const targetCell = table.querySelector('thead tr:not([disabled]) th:nth-child(' + cellIndex + ')');\n      targetCell.classList.remove('header-light');\n    };\n  }\n\n  ngAfterViewInit() {\n    const tbody = this.elementRef.nativeElement.querySelector('tbody');\n    this.tds = tbody.querySelectorAll('td:not([disabled])');\n\n    if (this.tds.length) {\n      this.deployListeners();\n    }\n  }\n\n  ngAfterViewChecked() {\n    const tbody = this.elementRef.nativeElement.querySelector('tbody');\n    const newTds = tbody.querySelectorAll('td:not([disabled])');\n\n    if (newTds.length !== this.tds.length) {\n      this.tds = newTds;\n      this.deployListeners();\n    }\n  }\n\n  deployListeners() {\n    this.destroyListeners();\n    this.initListeners();\n  }\n\n  initListeners() {\n    this.tds.forEach((td, i) => {\n      if (this.listeners.has(td)) {\n        const listener = this.listeners.get(td);\n        listener.index = i;\n        return;\n      }\n\n      this.listeners.set(td, {\n        mouseover: this.onMouseOver(),\n        mouseout: this.onMouseOut()\n      });\n\n      const listeners = this.listeners.get(td);\n      td.addEventListener('mouseover', listeners.mouseover);\n      td.addEventListener('mouseout', listeners.mouseout);\n    });\n  }\n\n  destroyListeners() {\n    this.listeners.forEach((a) => {\n      if (!this.listeners.has(a)) {\n        return;\n      }\n\n      const listeners = this.listeners.get(a);\n      a.removeEventListener('mouseover', listeners.mouseover);\n      a.removeEventListener('mouseout', listeners.mouseout);\n      this.listeners.delete(a);\n    });\n  }\n\n  ngOnDestroy() {\n    this.destroyListeners();\n  }\n}\n"],"names":[],"mappings":"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"}